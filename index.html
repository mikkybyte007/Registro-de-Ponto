<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Ponto Pessoal - Miqu√©ias</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

    <!-- Adi√ß√£o para PWA: Link para o manifest.json -->
    <link rel="manifest" href="/Registro-de-Ponto/manifest.json">
    <!-- Adi√ß√£o para PWA: √çcone para iOS (Safari) -->
    <link rel="apple-touch-icon" href="/Registro-de-Ponto/apple-touch-icon.png">

    <style>
        :root {
            --bg-color-light: #f0f2f5; /* Fundo claro */
            --text-color-light: #333; /* Texto escuro */
            --card-bg-light: #ffffff; /* Fundo de card claro */
            --border-color-light: #e0e0e0; /* Borda clara */
            --shadow-light: rgba(0, 0, 0, 0.08); /* Sombra suave clara */

            --bg-color-dark: #1e1e1e; /* Fundo escuro */
            --text-color-dark: #f0f0f0; /* Texto claro */
            --card-bg-dark: #2a2a2a; /* Fundo de card escuro */
            --border-color-dark: #3a3a3a; /* Borda escura */
            --shadow-dark: rgba(0, 0, 0, 0.3); /* Sombra suave escura */

            /* Cores prim√°rias e secund√°rias */
            --primary-color: #007aff; /* Azul do iOS */
            --primary-color-hover: #005bb5;
            --secondary-color-light: #e9ecef; /* Cinza claro */
            --secondary-color-dark: #4a4a4a; /* Cinza escuro */

            /* Estilo macOS */
            --macos-border-radius: 10px; /* Cantos mais arredondados */
            --macos-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); /* Sombra mais sutil */
            --macos-border: 1px solid rgba(0, 0, 0, 0.08); /* Borda discreta */
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px; /* Aumenta padding para um visual mais espa√ßoso */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
            background-color: var(--bg-color-light);
            color: var(--text-color-light);
            line-height: 1.5; /* Melhora a legibilidade */
        }

        body.dark-mode {
            background-color: var(--bg-color-dark);
            color: var(--text-color-dark);
        }

        .container {
            background-color: var(--card-bg-light);
            border: var(--macos-border); /* Borda macOS */
            border-radius: var(--macos-border-radius); /* Cantos arredondados macOS */
            box-shadow: var(--macos-shadow); /* Sombra macOS */
            padding: 25px; /* Aumenta padding */
            width: 100%;
            max-width: 650px; /* Ajusta max-width para melhor visualiza√ß√£o */
            margin-bottom: 20px; /* Aumenta margin-bottom */
            transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }

        body.dark-mode .container {
            background-color: var(--card-bg-dark);
            border-color: var(--border-color-dark);
            box-shadow: 0 2px 8px var(--shadow-dark); /* Sombra escura */
        }

        h1 {
            text-align: center;
            color: var(--text-color-light);
            margin-bottom: 25px; /* Aumenta margin-bottom */
            font-size: 2rem; /* Ajusta tamanho da fonte */
            font-weight: 600;
        }

        body.dark-mode h1 {
            color: var(--text-color-dark);
        }

        h2 {
            font-size: 1.6rem; /* Ajusta tamanho da fonte */
            margin-bottom: 15px;
            font-weight: 500;
        }

        .form-group {
            margin-bottom: 15px; /* Aumenta margin-bottom */
            display: flex;
            flex-direction: column;
            gap: 8px; /* Aumenta espa√ßamento entre label e input */
        }

        .form-group label {
            font-weight: 500;
            color: var(--text-color-light);
            font-size: 1rem; /* Ajusta tamanho da fonte */
        }

        body.dark-mode .form-group label {
            color: var(--text-color-dark);
        }

        .form-group input[type="date"],
        .form-group input[type="time"],
        .form-group input[type="number"] { /* Adicionado input type number */
            padding: 12px; /* Aumenta padding */
            border: 1px solid var(--border-color-light);
            border-radius: var(--macos-border-radius); /* Cantos arredondados macOS */
            font-size: 1rem;
            background-color: var(--card-bg-light);
            color: var(--text-color-light);
            transition: border-color 0.2s, background-color 0.2s, color 0.2s, box-shadow 0.2s;
            -webkit-appearance: none; /* Remove estilo padr√£o de input em iOS */
            min-width: 120px; /* Garante largura m√≠nima */
        }

        body.dark-mode .form-group input {
            background-color: var(--bg-color-dark);
            border-color: var(--border-color-dark);
            color: var(--text-color-dark);
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.2); /* Sombra de foco macOS */
        }

        .button-group {
            display: flex;
            flex-direction: column; /* Bot√µes empilhados em mobile */
            gap: 12px; /* Aumenta gap */
            margin-top: 20px; /* Aumenta margin-top */
            justify-content: center;
        }

        @media (min-width: 480px) {
            .button-group {
                flex-direction: row;
            }
        }

        button {
            padding: 14px 22px; /* Aumenta padding */
            border: none;
            border-radius: var(--macos-border-radius); /* Cantos arredondados macOS */
            font-size: 1.05rem;
            cursor: pointer;
            transition: background-color 0.2s, opacity 0.2s, box-shadow 0.2s;
            font-weight: 500;
            width: 100%; /* Ocupa largura total em mobile */
            box-shadow: var(--macos-shadow); /* Sombra macOS */
        }

        @media (min-width: 480px) {
            button {
                width: auto; /* Volta a largura autom√°tica em telas maiores */
            }
        }

        button.primary {
            background-color: var(--primary-color);
            color: white;
            box-shadow: 0 2px 6px rgba(0, 122, 255, 0.2);
        }

        button.primary:hover {
            background-color: var(--primary-color-hover);
            box-shadow: 0 4px 10px rgba(0, 122, 255, 0.3);
        }

        button.secondary {
            background-color: var(--secondary-color-light);
            color: var(--text-color-light);
            border: var(--macos-border); /* Borda macOS */
        }

        body.dark-mode button.secondary {
            background-color: var(--secondary-color-dark);
            border-color: var(--border-color-dark);
            color: var(--text-color-dark);
        }

        button.secondary:hover {
            opacity: 0.9;
        }

        #data-entries {
            margin-top: 25px; /* Aumenta margin-top */
            width: 100%;
        }

        #data-entries h2 {
            text-align: center;
            margin-bottom: 20px; /* Aumenta margin-bottom */
            color: var(--text-color-light);
        }

        body.dark-mode #data-entries h2 {
            color: var(--text-color-dark);
        }

        .entry-card {
            background-color: var(--card-bg-light);
            border: var(--macos-border); /* Borda macOS */
            border-radius: var(--macos-border-radius); /* Cantos arredondados macOS */
            padding: 15px; /* Aumenta padding */
            margin-bottom: 10px; /* Aumenta margin-bottom */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: flex-start;
            box-shadow: var(--macos-shadow); /* Sombra macOS */
            transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }

        body.dark-mode .entry-card {
            background-color: var(--card-bg-dark);
            border-color: var(--border-color-dark);
            box-shadow: 0 2px 8px var(--shadow-dark);
        }

        .entry-info {
            flex-grow: 1;
            color: var(--text-color-light);
            font-size: 0.95rem; /* Ajusta tamanho da fonte */
            margin-bottom: 12px; /* Espa√ßamento entre info e a√ß√µes */
            line-height: 1.5; /* Melhora a legibilidade do texto */
            word-break: break-word;
        }

        body.dark-mode .entry-info {
            color: var(--text-color-dark);
        }

        .entry-info strong {
            font-weight: 600;
        }

        .entry-actions {
            width: 100%;
            text-align: right;
        }

        .entry-actions button {
            background: none;
            border: none;
            color: #ff3b30; /* Vermelho do iOS */
            cursor: pointer;
            font-size: 1.3rem; /* Aumenta tamanho do √≠cone */
            padding: 8px; /* Aumenta padding */
            border-radius: var(--macos-border-radius); /* Cantos arredondados macOS */
            width: auto;
            box-shadow: none; /* Bot√£o de lixeira sem sombra */
        }

        .entry-actions button:hover {
            background-color: rgba(255, 59, 48, 0.1);
        }

        .theme-toggle {
            position: static;
            margin-bottom: 20px;
            background-color: var(--card-bg-light);
            border: var(--macos-border);
            border-radius: var(--macos-border-radius);
            padding: 10px 15px; /* Aumenta padding */
            cursor: pointer;
            font-size: 0.95rem;
            color: var(--text-color-light);
            transition: background-color 0.3s, border-color 0.3s, color 0.3s;
            width: 100%;
            max-width: 650px; /* Alinha com os containers */
            text-align: center;
            box-shadow: var(--macos-shadow);
        }

        body.dark-mode .theme-toggle {
            background-color: var(--card-bg-dark);
            border-color: var(--border-color-dark);
            color: var(--text-color-dark);
        }

        .theme-toggle:hover {
            opacity: 0.9;
        }

        @media (min-width: 768px) {
            .theme-toggle {
                position: absolute;
                top: 25px; /* Ajusta posi√ß√£o */
                right: 25px; /* Ajusta posi√ß√£o */
                width: auto;
                max-width: none;
            }
            .entry-card {
                flex-direction: row;
                align-items: center;
            }
            .entry-info {
                margin-bottom: 0;
            }
            .entry-actions {
                width: auto;
            }
        }

        #summary {
            margin-top: 25px;
            padding: 20px; /* Aumenta padding */
            background-color: var(--card-bg-light);
            border: var(--macos-border);
            border-radius: var(--macos-border-radius);
            box-shadow: var(--macos-shadow);
            width: 100%;
            max-width: 650px;
            color: var(--text-color-light);
            transition: background-color 0.3s, border-color 0.3s, box-shadow 0.3s;
        }

        body.dark-mode #summary {
            background-color: var(--card-bg-dark);
            border-color: var(--border-color-dark);
            box-shadow: 0 2px 8px var(--shadow-dark);
            color: var(--text-color-dark);
        }

        #summary p {
            margin-bottom: 8px;
            font-size: 1rem;
        }

        #summary p strong {
            font-weight: 600;
        }

        .footer {
            margin-top: 30px;
            font-size: 0.85rem;
            color: #888;
            text-align: center;
        }

        body.dark-mode .footer {
            color: #bbb;
        }
    </style>
</head>
<body>
    <button id="themeToggle" class="theme-toggle">Modo Escuro</button>

    <div class="container">
        <h1>Controle de Ponto Pessoal</h1>

        <div class="form-group">
            <label for="data">Data:</label>
            <input type="date" id="data" required>
        </div>

        <div class="form-group">
            <label for="entradaPrevista">Entrada Prevista:</label>
            <input type="time" id="entradaPrevista" value="08:00" required>
        </div>

        <div class="form-group">
            <label for="saidaPrevista">Sa√≠da Prevista:</label>
            <input type="time" id="saidaPrevista" value="17:00" required>
        </div>

        <div class="form-group">
            <label for="entradaReal">Entrada Real:</label>
            <input type="time" id="entradaReal" required>
        </div>

        <div class="form-group">
            <label for="saidaReal">Sa√≠da Real:</label>
            <input type="time" id="saidaReal" required>
        </div>

        <div class="form-group">
            <label for="editTolerance">Toler√¢ncia de Edi√ß√£o (minutos):</label>
            <input type="number" id="editTolerance" value="10" min="0">
        </div>

        <div class="button-group">
            <button id="addEntryBtn" class="primary">Adicionar Registro</button>
            <button id="generateExcelBtn" class="secondary">Gerar Excel</button>
            <button id="clearEntriesBtn" class="secondary">Limpar Todos</button>
        </div>
    </div>

    <div id="data-entries" class="container">
        <h2>Registros de Ponto</h2>
        <div id="entriesList">
            <!-- Registros ser√£o inseridos aqui -->
        </div>
    </div>

    <div id="summary" class="container">
        <h2>Resumo do Banco de Horas</h2>
        <p>Total de Horas Devidas/Extras Acumuladas: <strong id="totalBancoHoras">00:00</strong></p>
    </div>

    <footer class="footer">
        Autor: Miqu√©ias Lima
    </footer>

    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <script>
        // --- Constantes e Vari√°veis Globais ---
        const ENTRADA_PREVISTA_PADRAO = "08:00";
        const SAIDA_PREVISTA_PADRAO = "17:00";
        const JORNADA_PADRAO_MINUTOS = 8 * 60; // 8 horas em minutos

        let entries = [];
        let editToleranceMinutes = 10; // Valor padr√£o para a toler√¢ncia de edi√ß√£o

        // --- Elementos do DOM ---
        const dataInput = document.getElementById('data');
        const entradaPrevistaInput = document.getElementById('entradaPrevista');
        const saidaPrevistaInput = document.getElementById('saidaPrevista');
        const entradaRealInput = document.getElementById('entradaReal');
        const saidaRealInput = document.getElementById('saidaReal');
        const editToleranceInput = document.getElementById('editTolerance'); // Novo input
        const addEntryBtn = document.getElementById('addEntryBtn');
        const clearEntriesBtn = document.getElementById('clearEntriesBtn');
        const generateExcelBtn = document.getElementById('generateExcelBtn');
        const entriesList = document.getElementById('entriesList');
        const totalBancoHorasSpan = document.getElementById('totalBancoHoras');
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;

        // --- Fun√ß√µes de Utilit√°rio de Tempo ---
        function timeToMinutes(timeStr) {
            if (!timeStr) return 0;
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function minutesToTime(totalMinutes) {
            if (totalMinutes === 0) return "00:00";
            const sign = totalMinutes < 0 ? "-" : "";
            totalMinutes = Math.abs(totalMinutes);
            const hours = Math.floor(totalMinutes / 60);
            const minutes = totalMinutes % 60;
            return `${sign}${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}`;
        }

        function calculateTimeDifference(start, end) {
            const startMinutes = timeToMinutes(start);
            const endMinutes = timeToMinutes(end);
            return endMinutes - startMinutes;
        }

        // --- Fun√ß√µes de Gerenciamento de Registros ---
        function loadEntries() {
            const savedEntries = localStorage.getItem('pointEntries');
            if (savedEntries) {
                entries = JSON.parse(savedEntries);
            }
            // Carrega a toler√¢ncia salva ou usa o padr√£o
            const savedTolerance = localStorage.getItem('editTolerance');
            if (savedTolerance !== null) {
                editToleranceMinutes = parseInt(savedTolerance);
                editToleranceInput.value = editToleranceMinutes;
            }
            renderEntries();
        }

        function saveEntries() {
            localStorage.setItem('pointEntries', JSON.stringify(entries));
            localStorage.setItem('editTolerance', editToleranceMinutes); // Salva a toler√¢ncia
        }

        function renderEntries() {
            entriesList.innerHTML = '';
            let totalBancoHorasAcumulado = 0;

            entries.forEach((entry, index) => {
                // Recalcula horas para garantir que a toler√¢ncia atual seja aplicada
                const entradaPrevistaMin = timeToMinutes(entry.entradaPrevista);
                const saidaPrevistaMin = timeToMinutes(entry.saidaPrevista);
                const entradaRealMin = timeToMinutes(entry.entradaReal);
                const saidaRealMin = timeToMinutes(entry.saidaReal);

                let horasTrabalhadasDiaMin = calculateTimeDifference(entradaRealMin, saidaRealMin);

                // Calcula horas devidas/extras com toler√¢ncia
                let horasDevidasExtrasDiaMin = 0;
                if (entradaRealMin < entradaPrevistaMin - editToleranceMinutes) {
                    horasDevidasExtrasDiaMin += (entradaRealMin - (entradaPrevistaMin - editToleranceMinutes));
                } else if (entradaRealMin > entradaPrevistaMin + editToleranceMinutes) {
                    horasDevidasExtrasDiaMin += (entradaRealMin - (entradaPrevistaMin + editToleranceMinutes));
                }

                if (saidaRealMin > saidaPrevistaMin + editToleranceMinutes) {
                    horasDevidasExtrasDiaMin += (saidaRealMin - (saidaPrevistaMin + editToleranceMinutes));
                } else if (saidaRealMin < saidaPrevistaMin - editToleranceMinutes) {
                    horasDevidasExtrasDiaMin += (saidaRealMin - (saidaPrevistaMin - editToleranceMinutes));
                }

                // Ajusta o banco de horas acumulado
                totalBancoHorasAcumulado += horasDevidasExtrasDiaMin;

                entry.horasTrabalhadasDia = minutesToTime(horasTrabalhadasDiaMin);
                entry.horasDevidasExtrasDia = minutesToTime(horasDevidasExtrasDiaMin);
                entry.bancoHorasAcumulado = minutesToTime(totalBancoHorasAcumulado);

                const entryCard = document.createElement('div');
                entryCard.classList.add('entry-card');
                entryCard.innerHTML = `
                    <div class="entry-info">
                        <p><strong>Data:</strong> ${new Date(entry.data + 'T00:00:00').toLocaleDateString('pt-BR')}</p>
                        <p><strong>Entrada Prevista:</strong> ${entry.entradaPrevista} | <strong>Sa√≠da Prevista:</strong> ${entry.saidaPrevista}</p>
                        <p><strong>Entrada Real:</strong> ${entry.entradaReal} | <strong>Sa√≠da Real:</strong> ${entry.saidaReal}</p>
                        <p><strong>Horas Trabalhadas (Dia):</strong> ${entry.horasTrabalhadasDia}</p>
                        <p><strong>Horas Devidas/Extras (Dia):</strong> <span style="color: ${horasDevidasExtrasDiaMin < 0 ? '#ff3b30' : (horasDevidasExtrasDiaMin > 0 ? '#34c759' : 'inherit')}">${entry.horasDevidasExtrasDia}</span></p>
                        <p><strong>Banco de Horas Acumulado:</strong> <span style="color: ${totalBancoHorasAcumulado < 0 ? '#ff3b30' : (totalBancoHorasAcumulado > 0 ? '#34c759' : 'inherit')}">${entry.bancoHorasAcumulado}</span></p>
                    </div>
                    <div class="entry-actions">
                        <button data-index="${index}" aria-label="Remover registro">üóëÔ∏è</button>
                    </div>
                `;
                entriesList.appendChild(entryCard);
            });

            totalBancoHorasSpan.textContent = minutesToTime(totalBancoHorasAcumulado);
            totalBancoHorasSpan.style.color = totalBancoHorasAcumulado < 0 ? '#ff3b30' : (totalBancoHorasAcumulado > 0 ? '#34c759' : 'inherit');

            saveEntries();
        }

        function addEntry() {
            const data = dataInput.value;
            const entradaPrevista = entradaPrevistaInput.value || ENTRADA_PREVISTA_PADRAO;
            const saidaPrevista = saidaPrevistaInput.value || SAIDA_PREVISTA_PADRAO;
            const entradaReal = entradaRealInput.value;
            const saidaReal = saidaRealInput.value;

            if (!data || !entradaReal || !saidaReal) {
                alert('Por favor, preencha a data, entrada real e sa√≠da real.');
                return;
            }

            const newEntry = {
                data,
                entradaPrevista,
                saidaPrevista,
                entradaReal,
                saidaReal,
                horasTrabalhadasDia: '', // Ser√° calculado em renderEntries
                horasDevidasExtrasDia: '', // Ser√° calculado em renderEntries
                bancoHorasAcumulado: '' // Ser√° calculado em renderEntries
            };
            entries.push(newEntry);
            renderEntries();
            // Opcional: Limpa os campos de entrada, exceto a data para facilitar entradas sequenciais
            // entradaInput.value = ENTRADA_PREVISTA;
            // saidaInput.value = SAIDA_PREVISTA;
        }

        function deleteEntry(index) {
            if (confirm('Tem certeza que deseja remover este registro?')) {
                entries.splice(index, 1);
                renderEntries();
            }
        }

        function clearAllEntries() {
            if (confirm('Tem certeza que deseja limpar TODOS os registros? Esta a√ß√£o √© irrevers√≠vel.')) {
                entries = [];
                renderEntries();
                localStorage.removeItem('pointEntries');
            }
        }

        // --- Gera√ß√£o de Excel ---
        function generateExcel() {
            if (entries.length === 0) {
                alert('N√£o h√° registros para gerar o Excel.');
                return;
            }

            // Prepara os dados para o Excel
            const dataForExcel = entries.map(entry => ({
                'Data': new Date(entry.data + 'T00:00:00').toLocaleDateString('pt-BR'),
                'Entrada Prevista': entry.entradaPrevista,
                'Sa√≠da Prevista': entry.saidaPrevista,
                'Entrada Real': entry.entradaReal,
                'Sa√≠da Real': entry.saidaReal,
                'Horas Trabalhadas (Dia)': entry.horasTrabalhadasDia,
                'Horas Devidas/Extras (Dia)': entry.horasDevidasExtrasDia,
                'Banco de Horas Acumulado': entry.bancoHorasAcumulado
            }));

            const ws = XLSX.utils.json_to_sheet(dataForExcel);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Controle de Ponto");

            // Define o nome do arquivo com o per√≠odo (21 do m√™s anterior ao 20 do m√™s atual)
            const today = new Date();
            const currentDay = today.getDate();
            let startMonth, startYear, endMonth, endYear;

            if (currentDay > 20) {
                // Se estamos entre o dia 21 e o final do m√™s, o ciclo atual come√ßou no dia 21 deste m√™s
                startMonth = today.getMonth();
                startYear = today.getFullYear();
                endMonth = (startMonth + 1) % 12;
                endYear = (endMonth === 0) ? startYear + 1 : startYear;
            } else {
                // Se estamos entre o dia 1 e 20, o ciclo atual come√ßou no dia 21 do m√™s anterior
                endMonth = today.getMonth();
                endYear = today.getFullYear();
                startMonth = (endMonth === 0) ? 11 : endMonth - 1;
                startYear = (endMonth === 0) ? endYear - 1 : endYear;
            }

            const startDate = new Date(startYear, startMonth, 21);
            const endDate = new Date(endYear, endMonth, 20);

            const fileName = `Controle_Ponto_${startDate.toLocaleDateString('pt-BR', { month: 'short', year: 'numeric' }).replace(/\s/g, '_')}_a_${endDate.toLocaleDateString('pt-BR', { month: 'short', year: 'numeric' }).replace(/\s/g, '_')}.xlsx`;

            XLSX.writeFile(wb, fileName);
        }

        // --- Gerenciamento de Tema (Claro/Escuro) ---
        function applyTheme(isDarkMode) {
            if (isDarkMode) {
                body.classList.add('dark-mode');
                themeToggle.textContent = 'Modo Claro';
                localStorage.setItem('theme', 'dark');
            } else {
                body.classList.remove('dark-mode');
                themeToggle.textContent = 'Modo Escuro';
                localStorage.setItem('theme', 'light');
            }
        }

        function toggleTheme() {
            const isDarkMode = body.classList.contains('dark-mode');
            applyTheme(!isDarkMode);
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme');
            // Como voc√™ prefere o tema claro como padr√£o, vamos garantir isso.
            if (savedTheme === 'dark') {
                applyTheme(true);
            } else {
                applyTheme(false); // Padr√£o para claro
            }
        }

        // --- Event Listeners ---
        addEntryBtn.addEventListener('click', addEntry);
        clearEntriesBtn.addEventListener('click', clearAllEntries);
        generateExcelBtn.addEventListener('click', generateExcel);
        entriesList.addEventListener('click', (event) => {
            if (event.target.tagName === 'BUTTON' && event.target.dataset.index) {
                deleteEntry(parseInt(event.target.dataset.index));
            }
        });
        themeToggle.addEventListener('click', toggleTheme);

        // Listener para o input de toler√¢ncia
        editToleranceInput.addEventListener('change', (event) => {
            const newTolerance = parseInt(event.target.value);
            if (!isNaN(newTolerance) && newTolerance >= 0) {
                editToleranceMinutes = newTolerance;
                renderEntries(); // Recalcula e renderiza com a nova toler√¢ncia
            } else {
                alert('Por favor, insira um n√∫mero v√°lido para a toler√¢ncia (maior ou igual a 0).');
                editToleranceInput.value = editToleranceMinutes; // Volta ao valor anterior
            }
        });

        // --- Inicializa√ß√£o ---
        document.addEventListener('DOMContentLoaded', () => {
            // Define a data atual como padr√£o no campo de data
            dataInput.valueAsDate = new Date();
            loadTheme();
            loadEntries();
        });

        // --- Registro do Service Worker (para PWA) ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/Registro-de-Ponto/service-worker.js')
                    .then(registration => {
                        console.log('ServiceWorker registrado com sucesso:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Falha no registro do ServiceWorker:', error);
                    });
            });
        }
    </script>
</body>
</html>
